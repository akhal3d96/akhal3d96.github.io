!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(){$(".error_container").append('<div class="alert alert-danger" role="alert"><span style="font-weight:bold;">Ad Blocker detected! </span>this app needs to do some calls to Last.fm server and the adblocker, obviously, is blocking it so in order to make it runs properly, you have to <span style="font-weight:bold;">disable your adblocker.</span></div>')}function a(){$("input[value=Save]").css("visibility","visible"),window.loading.finish()}function i(e){var t=[];return e.match(/\d+\*\d+/)?t=e.split("*"):e.match(/\d+x\d+/)&&(t=e.split("x")),{rows:t[0],columns:t[1]}}var s=r(1),u=n(s),l=r(6).drawCollage,c=r(4);$("input[value=Save]").bind("click",function(){var e=document.querySelector(".canvas");e.toBlob(function(e){saveAs(e,"collage.png")})}),"undefined"==typeof fuckAdBlock?o():fuckAdBlock.onDetected(o),$($("input[type=button]")[0]).bind("click",function(){$("canvas").css("width","100%"),window.loading=c.showLoading(),$(".error_container").html(""),$("input[value=Save]").css("visibility","hidden");var e=$("form").serializeArray(),t=e[0].value,r=e[1].value,n=i(e[2].value),o=new u["default"](t);"weeklyalbumchart"==r?o.getWeeklyAlbums(n.rows,n.columns,function(e,t,r){try{l(e,t,r)}catch(n){a()}}):o.getTopAlbums(n.rows,n.columns,r,function(e,t,r){try{l(e,t,r)}catch(n){a()}})})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(2),s=n(i),u=r(5),l=n(u),c=r(3),f=r(4),m=function(){function e(t){o(this,e),this.username=t,this.UserAlbumsArray=[]}return a(e,[{key:"getTopAlbums",value:function(e,t,r,n){var o=this,a="https://ws.audioscrobbler.com/2.0/?method=user.gettopalbums&user="+this.username+"&api_key="+c.api_key+"&period="+r+"&limit="+e*t+"&format=json";try{$.getJSON(a,function(a){try{if(a.error)throw new Error("Wrong username.");var i=o,u=[];if(e*t>a.topalbums.album.length)throw new Error("You have "+a.topalbums.album.length+" albums which is fewer than the size your requested "+e+"x"+t);window.progressBar=new l["default"](c.progressBarID,e*t);for(var m=0;m<e*t;m++){var d=new s["default"](a.topalbums.album[m].artist.name,a.topalbums.album[m].name);o.UserAlbumsArray.push(d),u.push(d.getAlbumImage(a.topalbums.album[m].image[3]["#text"]))}$.when.apply($,u).done(function(){n(e,t,i.UserAlbumsArray)}).fail(function(){try{throw new Error("Somg images/image didn't load. Press Generate again")}catch(o){i.getTopAlbums(e,t,r,n),f.showError(o)}})}catch(h){f.showError(h)}}).fail(function(){try{throw new Error("Connection error.")}catch(e){f.showError(e)}})}catch(i){f.showError(i)}}},{key:"getWeeklyAlbums",value:function(e,t,r){var n=this,o="https://ws.audioscrobbler.com/2.0/?method=user.getweeklyalbumchart&user="+this.username+"&api_key="+c.api_key+"&format=json";this.size=e*c.image_size*(t*c.image_size);try{$.getJSON(o,function(o){try{if(o.error)throw new Error("Wrong username.");var a=n,i=[];if(e*t>o.weeklyalbumchart.album.length)throw new Error("You have "+o.weeklyalbumchart.album.length+" album which is fewer than the size you requested "+e+"x"+t);window.progressBar=new l["default"](c.progressBarID,e*t);for(var u=0;u<e*t;u++){var m=new s["default"](o.weeklyalbumchart.album[u].artist["#text"],o.weeklyalbumchart.album[u].name);n.UserAlbumsArray.push(m),i.push(m.getAlbumImage())}$.when.apply($,i).done(function(){r(e,t,a.UserAlbumsArray)}).fail(function(){try{throw new Error("Some images/image didn't load. Press Generate again.")}catch(n){a.getWeeklyAlbums(e,t,r),f.showError(n)}})}catch(d){f.showError(d)}}).fail(function(){try{throw new Error("Connection error.")}catch(e){f.showError(e)}})}catch(a){f.showError(a)}}},{key:"username",get:function(){return this._username},set:function(e){this._username=e}}]),e}();t["default"]=m},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(3),s=(r(4),function(){function e(t,r,o){n(this,e),this.artist=t,this.name=r,o&&(this.image=o)}return a(e,[{key:"getAlbumImage",value:function(e){var t=this,r=new Image;if(r.crossOrigin="anonymous",e){var n=this;return $.Deferred(function(t){r.onload=function(){n._image=r,window.progressBar.update(n),t.resolve(n._image)},r.onerror=function(){t.reject()},r.src=e}).promise()}var n,a=function(){var e="https://ws.audioscrobbler.com/2.0/?method=album.getinfo&api_key="+i.api_key+"&artist="+window.encodeURIComponent(t.artist)+"&album="+window.encodeURIComponent(t.name)+"&format=json";return n=t,{v:$.Deferred(function(t){$.getJSON(e,function(e){if(e.album.image[3]["#text"].length<=0){var o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsAQMAAABDsxw2AAAAA1BMVEX///+nxBvIAAAAIklEQVRo3u3BMQEAAADCoPVPbQo/oAAAAAAAAAAAAAAAeBkttAAB/+kJawAAAABJRU5ErkJggg==";r.src=o,n._image=r,t.resolve(n._image)}else r.onload=function(){n._image=r,window.progressBar.update(n),t.resolve(n._image)},r.onerror=function(){t.reject()},r.src=e.album.image[3]["#text"]})}).promise()}}();if("object"===("undefined"==typeof a?"undefined":o(a)))return a.v}},{key:"artist",get:function(){return this._artist},set:function(e){this._artist=e}},{key:"image",get:function(){return this._image},set:function(e){if("string"==typeof e){var t=new Image;t.src=e,this._image=t}else this._image=e}},{key:"name",set:function(e){this._name=e},get:function(){return this._name}}]),e}());t["default"]=s},function(e,t){"use strict";var r={api_key:"926f6ac421e0a673d09735dd68918d2c",image_size:300,progressBarID:"progress"};e.exports=r},function(e,t){"use strict";var r={showError:function(e){window.loading.finish(),$(".error_container").append('<div class="alert alert-danger" role="alert"><span style="font-weight:bold;">'+e+"</span></div>")},showLoading:function(){return pleaseWait({backgroundColor:"#DC4037",loadingHtml:'<p class="progress" style="color:white;"></p><div class="sk-wave"><div class="sk-rect sk-rect1"></div><div class="sk-rect sk-rect2"></div><div class="sk-rect sk-rect3"></div><div class="sk-rect sk-rect4"></div><div class="sk-rect sk-rect5"></div></div>'})}};e.exports=r},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(t,n){r(this,e),this.widthIncremention=100/n,this.oneIncrement=100/n,this.$Bar=$("."+t)}return n(e,[{key:"update",value:function(e){this.$Bar.text(e.artist+" â€” "+e.name+" ("+Math.floor(this.widthIncremention)+"%)"),this.widthIncremention+=this.oneIncrement}}]),e}();t["default"]=o},function(e,t,r){"use strict";var n=r(3),o={drawCollage:function(e,t,r){var o=document.querySelector("canvas"),a=o.getContext("2d");o.width=t*n.image_size,o.height=e*n.image_size,a.clearRect(0,0,o.width,o.height);var i=0,s=0,u=0,l=e*n.image_size*(t*n.image_size),c=parseInt(o.width),f=18,m="px Consolas,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New";for(a.font=f+m,a.strokeStyle="black",a.fillStyle="white";l;){if(c>=n.image_size){var d=parseInt(a.measureText(r[u].name).width),h=parseInt(a.measureText(r[u].artist).width);for(a.drawImage(r[u].image,i,s);d>n.image_size;){a.font=f--+m;var d=parseInt(a.measureText(r[u].name).width)}for(a.strokeText(r[u].name,i,s+20),a.fillText(r[u].name,i,s+20),a.font=f+m;h>n.image_size;){a.font=f--+m;var h=parseInt(a.measureText(r[u].artist).width)}a.strokeText(r[u].artist,i,s+40),a.fillText(r[u].artist,i,s+40),i+=n.image_size,c-=n.image_size,u++}else s+=n.image_size,i=0,c=parseInt(o.width);f=18,a.font=f+m,l-=n.image_size}}};e.exports=o}]);