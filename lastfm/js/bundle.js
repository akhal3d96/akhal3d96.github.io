!function(e){function t(a){if(r[a])return r[a].exports;var n=r[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=[];return e.match(/\d+\*\d+/)?t=e.split("*"):e.match(/\d+x\d+/)&&(t=e.split("x")),{rows:t[0],columns:t[1]}}var o=r(1),i=a(o),s=r(5).drawCollage,u=r(4);$("input[type=button]").bind("click",function(){var e=u.showLoading();window.setTimeout(function(){e.updateLoadingHtml('<p style="color:white;">We are working on your collage. You\'ve got a good taste by the way. ;-)</p><div class="sk-wave"><div class="sk-rect sk-rect1"></div><div class="sk-rect sk-rect2"></div><div class="sk-rect sk-rect3"></div><div class="sk-rect sk-rect4"></div><div class="sk-rect sk-rect5"></div></div>')},1800);var t=$("form").serializeArray(),r=t[0].value,a=t[1].value,o=n(t[2].value),c=new i["default"](r);"weeklyalbumchart"==a?c.getWeeklyAlbums(o.rows,o.columns,function(t,r,a){try{s(t,r,a)}catch(n){e.finish()}}):c.getTopAlbums(o.rows,o.columns,a,function(t,r,a){try{s(t,r,a)}catch(n){e.finish()}})})},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=r(2),s=a(i),u=r(3),c=r(4),l=function(){function e(t){n(this,e),this.username=t,this.UserAlbumsArray=[]}return o(e,[{key:"getTopAlbums",value:function(e,t,r,a){var n=this,o="https://ws.audioscrobbler.com/2.0/?method=user.gettopalbums&user="+this.username+"&api_key="+u.api_key+"&period="+r+"&limit="+e*t+"&format=json";try{$.getJSON(o,function(o){try{if(o.error)throw new Error("Wrong username.");var i=n,u=[];if(e*t>o.topalbums.album.length)throw new Error("You have "+o.topalbums.album.length+" albums which is fewer than the size your requested "+e+"x"+t);for(var l=0;l<e*t;l++){var m=new s["default"](o.topalbums.album[l].artist.name,o.topalbums.album[l].name);n.UserAlbumsArray.push(m),u.push(m.getAlbumImage(o.topalbums.album[l].image[3]["#text"]))}$.when.apply($,u).done(function(){a(e,t,i.UserAlbumsArray)}).fail(function(){try{throw new Error("Somg images/image didn't load.")}catch(n){i.getTopAlbums(e,t,r,a),c.showError(n)}})}catch(f){c.showError(f)}}).fail(function(){try{throw new Error("Connection error.")}catch(e){c.showError(e)}})}catch(i){c.showError(i)}}},{key:"getWeeklyAlbums",value:function(e,t,r){var a=this,n="https://ws.audioscrobbler.com/2.0/?method=user.getweeklyalbumchart&user="+this.username+"&api_key="+u.api_key+"&format=json";this.size=e*u.image_size*(t*u.image_size);try{$.getJSON(n,function(n){try{var o=a,i=[];if(e*t>n.weeklyalbumchart.album.length)throw new Error("You have "+n.weeklyalbumchart.album.length+" album which is fewer than the size you requested "+e+"x"+t);for(var u=0;u<e*t;u++){var l=new s["default"](n.weeklyalbumchart.album[u].artist["#text"],n.weeklyalbumchart.album[u].name);a.UserAlbumsArray.push(l),i.push(l.getAlbumImage())}$.when.apply($,i).done(function(){r(e,t,o.UserAlbumsArray)}).fail(function(){try{throw new Error("Some images/image didn't load")}catch(a){o.getWeeklyAlbums(e,t,r),c.showError(a)}})}catch(m){c.showError(m)}}).fail(function(){try{throw new Error("Connection error.")}catch(e){c.showError(e)}})}catch(o){c.showError(o)}}},{key:"username",get:function(){return this._username},set:function(e){this._username=e}}]),e}();t["default"]=l},function(e,t,r){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),i=r(3),s=function(){function e(t,r,n){a(this,e),this.artist=t,this.name=r,n&&(this.image=n)}return o(e,[{key:"getAlbumImage",value:function(e){var t=this,r=new Image;if(e){var a=this;return $.Deferred(function(t){r.onload=function(){a._image=r,t.resolve(a._image)},r.onerror=function(){t.reject()},r.src=e}).promise()}var a,o=function(){var e="https://ws.audioscrobbler.com/2.0/?method=album.getinfo&api_key="+i.api_key+"&artist="+window.encodeURIComponent(t.artist)+"&album="+window.encodeURIComponent(t.name)+"&format=json";return a=t,{v:$.Deferred(function(t){$.getJSON(e,function(e){if(e.album.image[3]["#text"].length<=0){var n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsAQMAAABDsxw2AAAAA1BMVEX///+nxBvIAAAAIklEQVRo3u3BMQEAAADCoPVPbQo/oAAAAAAAAAAAAAAAeBkttAAB/+kJawAAAABJRU5ErkJggg==";r.src=n,a._image=r,t.resolve(a._image)}else r.onload=function(){a._image=r,t.resolve(a._image)},r.onerror=function(){t.reject()},r.src=e.album.image[3]["#text"]})}).promise()}}();if("object"===("undefined"==typeof o?"undefined":n(o)))return o.v}},{key:"artist",get:function(){return this._artist},set:function(e){this._artist=e}},{key:"image",get:function(){return this._image},set:function(e){if("string"==typeof e){var t=new Image;t.src=e,this._image=t}else this._image=e}},{key:"name",set:function(e){this._name=e},get:function(){return this._name}}]),e}();t["default"]=s},function(e,t){"use strict";var r={api_key:"926f6ac421e0a673d09735dd68918d2c",image_size:300};e.exports=r},function(e,t){"use strict";var r={showError:function(e){$("<p class='error'>"+e+". <span class='bold'>Please click on generate button again.<span></p>").insertAfter("form")},showLoading:function(){return pleaseWait({backgroundColor:"#DC4037",loadingHtml:'<p style="color:white;">We are working on your collage.</p><div class="sk-wave"><div class="sk-rect sk-rect1"></div><div class="sk-rect sk-rect2"></div><div class="sk-rect sk-rect3"></div><div class="sk-rect sk-rect4"></div><div class="sk-rect sk-rect5"></div></div>'})}};e.exports=r},function(e,t,r){"use strict";var a=r(3),n={drawCollage:function(e,t,r){var n=document.querySelector("canvas"),o=n.getContext("2d");n.width=t*a.image_size,n.height=e*a.image_size,o.clearRect(0,0,n.width,n.height);var i=0,s=0,u=0,c=e*a.image_size*(t*a.image_size),l=parseInt(n.width),m=18,f="px Consolas,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New";for(o.font=m+f,o.strokeStyle="black",o.fillStyle="white";c;){if(l>=a.image_size){var h=parseInt(o.measureText(r[u].name).width),d=parseInt(o.measureText(r[u].artist).width);for(o.drawImage(r[u].image,i,s);h>a.image_size;){o.font=m--+f;var h=parseInt(o.measureText(r[u].name).width)}for(o.strokeText(r[u].name,i,s+20),o.fillText(r[u].name,i,s+20),o.font=m+f;d>a.image_size;){o.font=m--+f;var d=parseInt(o.measureText(r[u].artist).width)}o.strokeText(r[u].artist,i,s+40),o.fillText(r[u].artist,i,s+40),i+=a.image_size,l-=a.image_size,u++}else s+=a.image_size,i=0,l=parseInt(n.width);m=18,o.font=m+f,c-=a.image_size}}};e.exports=n}]);